
QTL Analysis Pipeline – README

This directory contains a suite of R scripts for comprehensive quantitative trait locus (QTL) analysis, covering allele frequency computation across ancestries, significance testing, fine-mapping, replication in external datasets (e.g., GTEx), and heritability estimation. Scripts are organized by analytical stage (a1–a4) to reflect the logical workflow.

Script Overview
a1.different_ancestries_freq.R
Computes allele frequencies of genetic variants across different ancestral populations to support ancestry-aware analyses.
a1.sig_QTL.R
Identifies statistically significant QTLs (e.g., eQTLs, sQTLs) using p-value thresholds or FDR correction.
a1.finemapping_QTL.R
Performs initial fine-mapping of significant QTL loci to prioritize likely causal variants.
a1.fm_SNV_QTL_add_freq.R
Integrates single-nucleotide variant (SNV) frequency information into fine-mapping results to contextualize variant prevalence across populations.
a2.QTL_replication_in_GTEx.R
Tests replication of study-identified QTLs in the GTEx dataset to assess robustness and generalizability.
a3.compare_with_GTEx.R
Systematically compares effect sizes, directions, and tissue-specificity of QTLs between this study and GTEx.
a4.calculate_he_QTLs.R
Estimates the heritability explained by QTLs using methods such as Haseman–Elston regression.
a4.mash_finemapping_QTLs.R
Applies the multivariate adaptive shrinkage (mash) framework to perform integrative fine-mapping across multiple tissues or conditions, improving causal variant resolution.

Usage Recommendations
Run scripts in order: a1 → a2 → a3 → a4 to follow the standard analytical pipeline.
Ensure input data (e.g., genotype VCFs, expression matrices, covariates) conform to each script’s expected format.
Required R packages include (but are not limited to): data.table, dplyr, ggplot2, mashr, and qvalue. Install dependencies before execution.
Scripts involving fine-mapping or mash modeling (a1.finemapping_QTL.R, a4.mash_finemapping_QTLs.R) are computationally intensive—run on high-performance computing (HPC) systems when possible.
